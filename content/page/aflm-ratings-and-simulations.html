---
title: Ratings and Simulations
author: James Day
date: '2018-03-27'
slug: aflm-ratings-and-simulations
categories:
  - AFLM
  - Simulation
tags: []
---



<p>Welcome to our all new AFL Men’s ratings and tips page! Here you will the latest ratings, tips for the upcoming rounds and any simulations that have been done. I’ll usually aim to update these early in the week to give you time to digest Any questions, let me know on Twitter!</p>
<pre class="r"><code># Load libraries
library(pacman)
pacman::p_load(fitzRoy, tidyverse, formattable, ggthemes, elo, here, lubridate)

# Load data that has been run using &#39;weekly_data_process.R&#39;
path &lt;- here::here(&quot;data&quot;, &quot;raw-data&quot;, &quot;AFLM.rds&quot;)
dat_list &lt;- read_rds(path)</code></pre>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>Below are the updated AFL Men’s ratings and simulations. These are based off our ELO model (insert explainer) and simulations (insert explainer).</p>
<p>First, let’s get our data into a good format.</p>
<pre class="r"><code># Get the round data
elo_round &lt;- dat_list$elo %&gt;%
  filter(Game == last(Game) &amp; !Team %in% c(&quot;Fitzroy&quot;, &quot;University&quot;))

# Combine Simulation and ELO data
elo_table &lt;- elo_round %&gt;%
  left_join(dat_list$sim.simple.summary, by = &quot;Team&quot;) %&gt;%
  mutate(ELO.change = ELO - ELO_pre) %&gt;%
  mutate_at(c(&quot;Top.8&quot;, &quot;Top.4&quot;, &quot;Top.1&quot;), percent, digits = 1) %&gt;%
  mutate_at(c(&quot;ELO&quot;, &quot;Wins&quot;, &quot;ELO.change&quot;), as.integer) %&gt;%
  select(Team, ELO, ELO.change, Wins, Top.8, Top.4, Top.1) %&gt;%
  arrange(desc(Wins))

#kable(elo_table)</code></pre>
<p>Now we can pass that table onto <code>formattable</code> and create a slightly nicer table.</p>
<pre class="r"><code># Write to formattable with some formatting
elo_table %&gt;%
  format_table(list(
    ELO = normalize_bar(&quot;#20B2AA80&quot;),
    Top.8 = color_tile(&quot;transparent&quot;, &quot;lightblue&quot;),
    Top.4 = color_tile(&quot;transparent&quot;, &quot;lightblue&quot;),
    Top.1 = color_tile(&quot;transparent&quot;, &quot;lightblue&quot;)
  ))</code></pre>
<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:right;">
Team
</th>
<th style="text-align:right;">
ELO
</th>
<th style="text-align:right;">
ELO.change
</th>
<th style="text-align:right;">
Wins
</th>
<th style="text-align:right;">
Top.8
</th>
<th style="text-align:right;">
Top.4
</th>
<th style="text-align:right;">
Top.1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
Richmond
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 97.03%">1594</span>
</td>
<td style="text-align:right;">
-7
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">0.8847</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">0.6842</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #add8e6">0.3496</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Sydney
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 86.14%">1572</span>
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #b2dae7">0.8249</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #bddfea">0.5510</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #daedf3">0.1575</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Adelaide
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 100.00%">1600</span>
</td>
<td style="text-align:right;">
-8
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #b0d9e6">0.8533</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #bfe0eb">0.5283</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #e6f3f7">0.1060</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Port Adelaide
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 76.73%">1553</span>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #badeea">0.7445</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #c7e4ee">0.4631</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #e3f1f6">0.1182</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
GWS
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 81.19%">1562</span>
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #badeea">0.7477</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #cee8f0">0.4038</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #edf6f9">0.0729</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Geelong
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 70.30%">1540</span>
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #c4e3ed">0.6462</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #daedf3">0.3071</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #f1f8fa">0.0595</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Essendon
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 53.96%">1507</span>
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #d0e8f0">0.5197</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #e4f2f6">0.2282</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #f4fafb">0.0442</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Hawthorn
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 51.49%">1502</span>
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #d5ebf2">0.4656</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #e9f4f8">0.1859</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #f8fbfc">0.0283</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
St Kilda
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 45.54%">1490</span>
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #dfeff5">0.3694</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #eef7f9">0.1426</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #f8fcfd">0.0261</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Collingwood
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 44.06%">1487</span>
</td>
<td style="text-align:right;">
-10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ddeff4">0.3899</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #f2f8fb">0.1114</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fcfdfe">0.0091</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Melbourne
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 52.97%">1505</span>
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #deeff5">0.3751</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #f0f8fa">0.1250</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fbfdfd">0.0146</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
West Coast
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 48.51%">1496</span>
</td>
<td style="text-align:right;">
-8
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #dff0f5">0.3672</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #f2f8fb">0.1101</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fdfefe">0.0085</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Footscray
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 35.64%">1470</span>
</td>
<td style="text-align:right;">
-21
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #e7f3f7">0.2864</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #f7fbfc">0.0673</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fefefe">0.0016</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
North Melbourne
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 28.22%">1455</span>
</td>
<td style="text-align:right;">
-6
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #f2f9fb">0.1692</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fbfdfe">0.0296</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fefefe">0.0010</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Carlton
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 12.87%">1424</span>
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #f2f9fb">0.1729</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fafcfd">0.0396</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fefefe">0.0018</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Gold Coast
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 7.43%">1413</span>
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fafcfd">0.0894</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fefefe">0.0126</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fefefe">0.0007</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Brisbane Lions
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 0.00%">1398</span>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fefefe">0.0476</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fefefe">0.0058</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #fefefe">0.0003</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Fremantle
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; border-radius: 4px; padding-right: 2px; background-color: rgba(32, 178, 170, 0.5); width: 0.50%">1399</span>
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0.0463</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0.0044</span>
</td>
<td style="text-align:right;">
<span style="display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff">0.0001</span>
</td>
</tr>
</tbody>
</table>
<p>And below you can see the change in ratings for each team.</p>
<pre class="r"><code># Create a subtitle for plot
subt &lt;- paste(
  &quot;Showing the ELO rating of each AFL Men&#39;s team at the end of Round&quot;,
  dat_list$elo$Round.Number %&gt;% last(), &quot;&quot;,
  dat_list$elo$Date %&gt;% last() %&gt;% year(),
  &quot;in green,\nwith the tail showing their previous rating&quot;
)

# Do ggplot
elo_round %&gt;%
  ggplot(aes(x = reorder(Team, ELO))) +
  geom_hline(yintercept = 1500, alpha = 0.7, linetype = 3) +
  geom_linerange(aes(ymin = ELO_pre, ymax = ELO), alpha = 0.3) +
  geom_point(aes(y = ELO_pre), alpha = 0.1) +
  geom_point(aes(y = ELO), colour = &quot;#669999&quot;, size = 2) +
  coord_flip() +
  theme_minimal() +
  labs(
    x = &quot;Team&quot;,
    y = &quot;ELO Rating&quot;,
    title = &quot;AFL Men&#39;s ELO Ratings&quot;,
    subtitle = subt,
    caption = &quot;(data sourced from afltables.com)&quot;
  )</code></pre>
<p><img src="/page/aflm-ratings-and-simulations_files/figure-html/ratings-plot-1.png" width="672" /></p>
</div>
