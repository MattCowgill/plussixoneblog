---
title: 'World Cup Datathon: Part 4 - Modelling'
author: James Day
date: '2018-06-15'
slug: world-cup-datathon-part-4-modelling
categories:
  - World Cup Datathon
tags: []
subtitle: ''
draft: true
---



<p>Firstly, reading that data in caused some issues with <code>betfair</code> columns. I’m guessing because there is missing data, it’s rading it as a character.</p>
<div id="pre-processing" class="section level1">
<h1>Pre-Processing</h1>
<div id="imputation" class="section level2">
<h2>Imputation</h2>
<p>For our missing data, we could simply delete all of the rows that has missing data. That would get rid about about 30% of our data however. Another method is to inpute those missing values. This can be problematic as well by reducing variance in the data. I’m taking a bit of a mixed approach. First, I’ll remove early data from the set. Then remove any data with missing values in <code>last_10_games</code> since this data will have unstable <code>elo</code> values anyway. Whatever is left will be imputed during <code>preProcess</code>.</p>
</div>
<div id="near-zero-variance" class="section level2">
<h2>Near zero variance</h2>
<p>According to the <a href="https://topepo.github.io/caret/pre-processing.html#zero--and-near-zero-variance-predictors">caret documentation</a> - it is good to check for this and caret has a built in tool.</p>
<p>So - all of our data, apart from <code>is_team_2_home</code> passes the tests of zero variance. They also have a good <code>freqRatio</code>, which according to the documentation should be less than</p>
</div>
<div id="section" class="section level2">
<h2></h2>
</div>
</div>
<div id="split" class="section level1">
<h1>Split</h1>
</div>
<div id="modelling" class="section level1">
<h1>Modelling</h1>
<p>I’m using the <code>caret</code> package for this. The nice thing about <code>caret</code> is that you can use a very big range of machine learning models and they all use very simplir inputs, functions and outputs, which makes the code consistent. This also allows easy comparison between models.</p>
<div id="base-model" class="section level2">
<h2>Base Model</h2>
<p>Firstly, we want a baseline model to compare our new models to. This is simply taken the number of times team 1 wins, draws and loses across our whole dataset and giving that the odds for each row.</p>
</div>
<div id="caret-models" class="section level2">
<h2>Caret Models</h2>
<div id="create-control" class="section level3">
<h3>Create Control</h3>
<p>One of the things I need to do first is to create a ‘control’ parameters object. This can be passed to each model to control some of the computational aspects of the <code>train</code> function. A lot of these have been taken from tutorials so I’m guessing a bit. I know that I need <code>classProbs = TRUE</code> and <code>summaryFunction = mnLogLoss</code> to do our logloss function later on.</p>
</div>
<div id="cart" class="section level3">
<h3>CART</h3>
<p>The first one I want to try is a classification and regression tree (CART). A lot of tutorials have reccomended these since they are pretty easy to interpret at the end. At the most basic level, these trees keen making binary decisions on a data-point to try and clasify each point into a group of points. There are various rules and parameters which control what those ‘split’ looks like.</p>
<p>I’ll be using the <code>rpart</code> method for my CART model.</p>
<div id="train" class="section level4">
<h4>Train</h4>
<p>Firslty, we can train our model. As I mentioned, the <code>caret</code> package is nice in that it allows a consistant format for applying machine learning algorithms. The training part is all done by the <code>train</code> function!</p>
<p>First, we pass it our formula - in this case, we are trying to predict the <code>outcome</code> variable from all others. So we write <code>outcome ~ .</code>. Next, we give it our trianing data, specify the method. I also pass it the control object from the previous step. I do some pre-processing - I’m doing this because our numeric data was largely not normally distributed. I’m unsure if this is correct but I’ll do some more reading.</p>
</div>
<div id="test" class="section level4">
<h4>Test</h4>
</div>
<div id="train-1" class="section level4">
<h4>Train</h4>
</div>
<div id="test-1" class="section level4">
<h4>Test</h4>
</div>
</div>
</div>
</div>
